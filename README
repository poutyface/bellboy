Mapped function is called when a file descriptor associated is readable (using select(2)).

Example: Watch STDIN

#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>

#include "logger.h"
#include "checker.h"
#include "boolean.h"
#include "bellboy.h"


static int KeyBoard_receive(int fd, void *data)
{
  char buf[256];
  memset(buf, 0, 80);
  read(fd, buf, 80);
  printf("%s %s\n", (unsigned char*)data, buf);
  return 0;
}


static void BellBoy_receive(BellBoyEvent what, void *data)
{
  switch(what){
  case BellBoyHeartbeat:
    printf("HeartBeat\n");
    break;
  case BellBoyRuntimeError:
    printf("RuntimeError\n");
    break;
  }
}


int main()
{
  int rs;

  rs = BellBoy_create(BellBoy_receive, NULL);
  check(rs == succeed, "should success to BellBoy_create");

  // Mapping KEYBOARD(STDIN) -> KeyBoard_recieve
  rs = BellBoy_map(KEYBOARD, KeyBoard_receive, "KEYBOARD "); 
  check(rs == succeed, "should success to BellBoy_map");

  BellBoy_start();
  BellBoy_shutdown();

  return succeed;

 error:
  return fail;
}
